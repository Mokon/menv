<script>
  function renderer(states, object){
    if (object.value in states) {
      color = states[object.value].color;
    } else {
      color = 'black';
    }

    object.style = {
      background: color,
      color: 'black'
    };

    return object;
  }

  function cellTip(states, object){
    if (object.value in states) {
      return states[object.value].cellTip;
    } else {
      return false;
    }
  }

  var reviewStates = {
    'final':    {'color': 'green',
                 'cellTip': 'Asking for final review comment'},
    'start':    {'color': 'lime',
                 'cellTip': 'Ready to review'},
    'comments': {'color': 'orange',
                 'cellTip': 'I am fixing review comments'},
    'na':       {'color': 'red',
                 'cellTip': 'Ignore this task'},
  };

  var testingStates = {
    'passed':   {'color': 'green',
                 'cellTip': 'This has passed all testing'},
    'running':  {'color': 'lime',
                 'cellTip': 'Testing is currently running'},
    'na':       {'color': 'orange',
                 'cellTip': 'Ignore this task'},
    'failed':   {'color': 'red',
                 'cellTip': 'Testing failed'},
  };
  var statusStates = {
    'jenkins':  {'color': 'yellow',
                 'cellTip': 'This is a jenkins related bug that has not been started.'},
    'review':   {'color': 'green',
                 'cellTip': 'This is in review, please review if you can'},
    'active':   {'color': 'lime',
                 'cellTip': 'I am actively working on this, no need to review'},
    'on hold':  {'color': 'orange',
                 'cellTip': 'I am not currently looking at this, no need to review'},
    'dup':      {'color': 'orange',
                 'cellTip': 'This is a duplicate task and will be closed, no need to review'},
    'watching': {'color': 'olive',
                 'cellTip': 'I am just watching this task, no need to review'},
    'declined': {'color': 'olive',
                 'cellTip': 'I have decline this task, no need to review'},
    'future':   {'color': 'red',
                 'cellTip': 'This task is for the future'},
  };

  var taskColumns = [{
        index: 'task',
        title: 'Task',
        type: 'string',
        width: 500
      },{
        index: 'bb',
        title: 'BitBucket',
        type: 'string',
      },{
        index: 'jira',
        title: 'Jira',
        type: 'string',
      },{
        index: 'status',
        title: 'Status',
        type: 'string',
        cellTip: function (o) { return cellTip(statusStates, o); },
        render: function (o) { return renderer(statusStates, o); }
      },{
        index: 'testing',
        title: 'Testing',
        type: 'string',
        cellTip: function (o) { return cellTip(testingStates, o); },
        render: function (o) { return renderer(testingStates, o); }
      },{
        index: 'review',
        title: 'Review',
        type: 'string',
        cellTip: function (o) { return cellTip(reviewStates, o); },
        render: function (o) { return renderer(reviewStates, o); },
      },{
        index: '',
        title: '',
        type: 'string',
        flex: 1
      }];

  var task_groups = {{{json task_groups}}};
  var title = 'Dashboard'

  task_groups.forEach(function(group) {
    tabs.push({
      title: group.group,
	    type: 'grid',
      selModel: 'row',
	    data: group.tasks,
      defaults: defaults,
      columns: taskColumns
    })
  })
</script>
