#!/bin/bash
# (C) 2013-2014 David 'Mokon' Bond, All Rights Reserved

spushd .

cd ${menv_cache_dir}

mpwp="http://mokonphotography.com/wp-content/uploads"
background_urls=(
  "$mpwp/2013/11/ca_2013_8_1-205.jpg"
  "$mpwp/2013/11/hannah-emb.jpg"
  "$mpwp/2013/11/Formal209.jpg"
  "$mpwp/2013/11/camping-965.jpg"
  "$mpwp/2013/11/misc-100.jpg"
  "$mpwp/2013/11/hannah-geek4.jpg"
  "$mpwp/2013/11/DSC_0188.jpg"
  "$mpwp/2013/11/ca_2013_8_1-239.jpg"
  "$mpwp/2013/11/img_0014.jpg"
  "$mpwp/2013/11/ca_2013_8_1-217.jpg"
  "$mpwp/2013/11/hannah-geek.jpg"
  "$mpwp/2013/11/ca_2013_8_1-066.jpg"
  "$mpwp/2013/11/ca_2013_8_1-177.jpg"
)
i=$(($RANDOM % ${#background_urls[@]}))
background_url=${background_urls[$i]}

echo "Setting wallpaper to $background_url"

if [ ! -d wallpapers ] ; then
  mkdir wallpapers
fi

if [ ! -f  wallpapers/${i}.jpg ] ; then
  fetch ${background_url} wallpapers/${i}.jpg
  gsettings set org.gnome.desktop.background picture-uri ${menv_cache_dir}/wallpapers/${i}.jpg
fi

cd ~

FAV_APPS="['gnome-terminal.desktop', 'virt-manager.desktop', 'nautilus.desktop', 'skype.desktop', 'cheese.desktop', 'gedit.desktop', 'google-chrome.desktop', "
function add_app {
  local app="${1}.desktop"
  cp $menv_dotfiles_dir/local/share/applications/${app} .local/share/applications/${app}
  FAV_APPS="$FAV_APPS '${app}',"
}

add_app root-wireshark
add_app gnome-start
gsettings set org.gnome.shell favorite-apps "${FAV_APPS%?}]"

unset add_app

PALETTE="['rgb(0,0,0)', 'rgb(205,0,0)', 'rgb(0,205,0)', 'rgb(205,205,0)', 'rgb(30,144,255)', 'rgb(205,0,205)', 'rgb(0,205,205)', 'rgb(229,229,229)', 'rgb(76,76,76)', 'rgb(255,0,0)', 'rgb(0,255,0)', 'rgb(255,255,0)', 'rgb(70,130,180)', 'rgb(255,0,255)', 'rgb(0,255,255)', 'rgb(255,255,255)']"
BG_COLOR="rgb(0,0,0)"
FG_COLOR="rgb(0,255,0)"
BD_COLOR="#9393a1a1a1a1"

p="/org/gnome/terminal/legacy/profiles:/"
profiles=($(dconf list $p | grep ^: | sed 's/\///g'))
for i in ${!profiles[*]} ; do
  if [[ "$(dconf read $p${profiles[i]}/visible-name)" == "'Default'" ]]
    then uuid="${profiles[i]}"
  fi
done
p="$p$uuid"
dconf write $p/palette "[$PALETTE]"

dconf write $p/bold-color "'$BD_COLOR'"
dconf write $p/background-color "'$BG_COLOR'"
dconf write $p/foreground-color "'$FG_COLOR'"

dconf write $p/use-theme-colors "false"
dconf write $p/use-theme-background "false"
dconf write $p/bold-color-same-as-fg "false"

dconf write $p/scrollback-unlimited "true"

spopd

